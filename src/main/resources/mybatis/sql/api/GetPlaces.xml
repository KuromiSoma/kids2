<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kdc.mybatis.mapper.api.GetPlacesMapper">
    <select id="getPlaceList" resultType="com.kdc.mybatis.domain.api.getplaces.PlaceInfoDomain">
        SELECT
            M.place_id                                      AS  placeid,
            M.place_name                                    AS  placename,
            M.place_type_flg                                AS  placetypeflg,
            M.longitude_and_latitude[0]                     AS  latitude,
            M.longitude_and_latitude[1]                     AS  longitude,
            M.radius                                        AS  radius,
            M.icon_id                                       AS  iconid,

            D.place_disp_flg                                AS  placedispflg

        FROM
            place_master M,
            place_display_config D,
            user_master U

        WHERE
            M.place_id = D.place_id
        AND D.auth_level = U.auth_level
        AND D.place_disp_flg = 1
        AND M.del_flg = 0
        AND D.del_flg = 0
        AND U.del_flg = 0
        AND U.user_id = #{userid}
        AND U.group_id = M.group_id
        ORDER BY
            M.place_id
    </select>
</mapper>